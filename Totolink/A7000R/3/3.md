# Totolink A7000R Has an command injection vulnerability

## 1. Affected version:

Totolink A7000R V9.1.0u.6115_B20201022(Transition version)

## 2. Firmware download address

[TOTOLINK](https://www.totolink.net/home/menu/detail/menu_listtpl/download/id/171/ids/36.html)
![image](https://user-images.githubusercontent.com/73413552/221508389-e59a233e-a4fb-4a77-9e58-62f8b0d1df0d.png)

## 3. Vulnerability details

The function "sub_423970" contains a Command Injection Caused by Format String Vulnerabilities. 
In the function, Attackers can control v48 by controlling the hostName parameter, and then control the parameters of the doSystem functionã€‚
As a result, by requesting the page, an attacker can easily execute a Dos attack or RCE with carefully crafted overflow data.


![image](https://user-images.githubusercontent.com/73413552/221512750-00e0c3be-7b6c-4045-bfa8-c99b2cccf8be.png)



## 4. Recurring vulnerabilities and POC

Due to China legal and policy reasons, we are unable to provide the exploit for tis vulnerability at this time.

## 5. Author

Mark @KRLab
